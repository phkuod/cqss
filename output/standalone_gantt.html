<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CQSS Project Gantt Chart</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f8f9fa;
            height: 100vh;
            overflow: hidden;
        }
        
        .container {
            width: 100%;
            height: calc(100vh - 40px);
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            display: flex;
            flex-direction: column;
        }
        
        .header {
            text-align: center;
            padding: 15px 20px;
            border-bottom: 2px solid #e9ecef;
            flex-shrink: 0;
            background: white;
            border-radius: 8px 8px 0 0;
        }
        
        .header h1 {
            color: #343a40;
            margin: 0;
            font-size: 2.2em;
        }
        
        .header p {
            color: #6c757d;
            margin: 8px 0 0 0;
            font-size: 1.0em;
        }
        
        .gantt-container {
            flex: 1;
            overflow: auto;
            border: none;
            position: relative;
        }
        
        .gantt-chart {
            width: 100%;
            height: 100%;
        }
        
        /* Custom scrollbar styling */
        .gantt-container::-webkit-scrollbar {
            width: 12px;
            height: 12px;
        }
        
        .gantt-container::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 6px;
        }
        
        .gantt-container::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 6px;
        }
        
        .gantt-container::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
        
        .gantt-container::-webkit-scrollbar-corner {
            background: #f1f1f1;
        }
        
        .axis {
            font-size: 12px;
        }
        
        .axis-label {
            font-size: 14px;
            font-weight: bold;
            fill: #495057;
        }
        
        .project-row {
            cursor: pointer;
        }
        
        .project-label {
            font-size: 13px;
            font-weight: 500;
            fill: #343a40;
        }
        
        .preparing-bar {
            fill: #6c757d;
            stroke: #495057;
            stroke-width: 1;
        }
        
        .execution-bar {
            stroke: #343a40;
            stroke-width: 1;
        }
        
        .progress-bar {
            opacity: 0.8;
        }
        
        .priority-critical { fill: #dc3545; }
        .priority-high { fill: #fd7e14; }
        .priority-medium { fill: #ffc107; }
        .priority-low { fill: #28a745; }
        
        .tooltip {
            position: absolute;
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 12px;
            border-radius: 6px;
            font-size: 13px;
            line-height: 1.4;
            max-width: 300px;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            pointer-events: none;
        }
        
        .tooltip-title {
            font-weight: bold;
            font-size: 14px;
            margin-bottom: 8px;
            color: #fff;
        }
        
        .tooltip-item {
            margin: 4px 0;
        }
        
        .legend {
            padding: 15px 20px;
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 20px;
            border-top: 1px solid #e9ecef;
            background: white;
            border-radius: 0 0 8px 8px;
            flex-shrink: 0;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 13px;
            color: #495057;
        }
        
        .legend-color {
            width: 20px;
            height: 15px;
            border-radius: 3px;
            border: 1px solid #ccc;
        }

        .controls {
            padding: 10px 20px;
            background: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-shrink: 0;
        }

        .controls button {
            padding: 5px 10px;
            margin: 0 2px;
            border: 1px solid #ccc;
            background: white;
            border-radius: 3px;
            cursor: pointer;
        }

        .controls button:hover {
            background: #e9ecef;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>CQSS Project Gantt Chart</h1>
            <p>Cyber Query Security System - Project Timeline Overview</p>
        </div>
        
        <div class="controls">
            <div>
                <button onclick="zoomIn()">Zoom In</button>
                <button onclick="zoomOut()">Zoom Out</button>
                <button onclick="resetZoom()">Reset</button>
            </div>
            <div>
                <span id="project-count">Loading projects...</span>
            </div>
        </div>
        
        <div class="gantt-container" id="gantt-container">
            <svg class="gantt-chart"></svg>
        </div>
        
        <div class="legend">
            <div class="legend-item">
                <div class="legend-color" style="background-color: #6c757d;"></div>
                <span>Preparing</span>
            </div>
            <div class="legend-item">
                <div class="legend-color priority-critical"></div>
                <span>Critical Priority</span>
            </div>
            <div class="legend-item">
                <div class="legend-color priority-high"></div>
                <span>High Priority</span>
            </div>
            <div class="legend-item">
                <div class="legend-color priority-medium"></div>
                <span>Medium Priority</span>
            </div>
            <div class="legend-item">
                <div class="legend-color priority-low"></div>
                <span>Low Priority</span>
            </div>
        </div>
    </div>
    
    <div class="tooltip" id="tooltip" style="display: none;"></div>
    
    <script>
        // Embedded D3.js v7 library - this makes the file standalone
        !function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):(t="undefined"!=typeof globalThis?globalThis:t||self,n(t.d3=t.d3||{}))}(this,function(t){"use strict";function n(t,n){return null==t||null==n?NaN:t<n?-1:t>n?1:t>=n?0:NaN}function e(t,n){return null==t||null==n?NaN:n<t?-1:n>t?1:n>=t?0:NaN}function r(t){let e,r,i;function o(t,n,e=0,r=t.length){if(e<r){if(0!==i(n,n))return r;do{const i=e+r>>>1;o(t[i],n)<0?e=i+1:r=i}while(e<r)}return e}return 2!==t.length?(i=n,e=(n,e)=>t(n)-e,r=(n,e)=>t(n)-t(e)):(e=t===n||t===e?t:s,r=t,i=t),{left:o,center:function(t,n,e=0,r=t.length){const i=o(t,n,e,r-1);return i>e&&r(t[i-1],n)>-r(t[i],n)?i-1:i},right:function(t,n,e=0,r=t.length){if(e<r){if(0!==i(n,n))return r;do{const i=e+r>>>1;o(t[i],n)<=0?e=i+1:r=i}while(e<r)}return e}}}function s(){return 0}function i(t){return null===t?NaN:+t}function o(t,n){let e;return void 0===n&&(n=i),1===t.length&&(n=t,t=i),{left:(e=r(n).left,function(n,r,s=0,i=n.length){return e(n,t(r),s,i)}),center:function(e,r,s=0,i=e.length){return n.center(e,t(r),s,i)},right:function(e,r,s=0,i=e.length){return n.right(e,t(r),s,i)}}}const a=r(n),u=a.right,c=a.left;function f(t,n){return[t,n]}function l(t){return null===t?NaN:+t}function h(t){return t}function d(t){let n,e,r=h;function s(t){let s,i,o=t.length,a=0,u=new Array(o);for(s=0;s<o;++s)isNaN(i=+r(t[s],s,t))||(u[a++]=i);return n(u.subarray(0,a))}return s.value=function(t){return arguments.length?(r="function"==typeof t?t:h,s):r},e&&(s.domain=e),n&&(s.range=n),s}function p(t,n){let e,r=0,s=t.length,i=t[r];for(;++r<s;)(e=n(i,t[r]))>0&&(i=t[r]);return i}function g(t,n){let e,r=0,s=t.length,i=t[r];for(;++r<s;)(e=n(i,t[r]))<0&&(i=t[r]);return i}function y(t,n){let e=0,r=t.length;if(r>0)for(;--r>=0;)e+=+n(t[r],r,t)||0;return e}function v(t,n){let e=0,r=t.length,s=-1,i,o=t[0];for(;++s<r;)isNaN(i=+n(o=t[s],s,t))||(e+=i);return e}function m(t){return function(n,e,r=0,s=n.length){let i=new t;if(r>=s)return i;let o,a=n[r];for(i.add(a);++r<s;)isNaN(o=+e(a=n[r],r,n))||(o=+o)>=o&&i.add(o);return i}}const b=m(Array);function _(t,n){let e,r=0,s=t.length;if(void 0===n)for(;r<s;)if(null!=(e=t[r++])&&e>=e)for(n=e;++r<s;)null!=(e=t[r])&&n>e&&(n=e);else for(;r<s;)if(null!=(e=t[r++])&&e>=e){for(n=e;++r<s;)null!=(e=t[r])&&n>e&&(n=e);break}return n}function w(t,n,e=0,r=t.length){if(e<r){if(0!==n(n,n))return;do{const s=e+r>>>1;n(t[s])<0?e=s+1:r=s}while(e<r)}return e}const x=Math.sqrt(50),N=Math.sqrt(10),A=Math.sqrt(2);function T(t,n,e){const r=(n-t)/Math.max(0,e),s=Math.floor(Math.log10(r)),i=r/Math.pow(10,s),o=i>=x?10:i>=N?5:i>=A?2:1;let a,u,c;return s<0?(c=Math.pow(10,-s)/o,a=Math.round(t*c),u=Math.round(n*c),a/c<t&&++a,u/c>n&&--u,c=1/c):(c=Math.pow(10,s)*o,a=Math.round(t/c),u=Math.round(n/c),a*c<t&&++a,u*c>n&&--u),u<a&&.5<=e&&e<2?T(t,n,2*e):[a,u,c]}function S(t,n,e){if(!((e=+e)>0))return[];if((t=+t)===(n=+n))return[t];const r=n<t,[s,i,o]=T(r?n:t,r?t:n,e);if(!(i>=s))return[];const a=i-s+1,u=new Array(a);if(r)if(o<0)for(let t=0;t<a;++t)u[t]=(i-t)/o;else for(let t=0;t<a;++t)u[t]=(i-t)*o;else if(o<0)for(let t=0;t<a;++t)u[t]=(s+t)/o;else for(let t=0;t<a;++t)u[t]=(s+t)*o;return u}function M(t,n,e){return T(t,n,e)[2]}function E(t,n,e){const r=T(t,n,e);return S(r[0],r[1],r[2])}function k(t,n){let e;if(void 0===n)for(const n of t)null!=n&&(e<n||void 0===e&&n>=n)&&(e=n);else{let r=-1;for(let s of t)null!=(s=n(s,++r,t))&&(e<s||void 0===e&&s>=s)&&(e=s)}return e}function C(t,n){let e;if(void 0===n)for(const n of t)null!=n&&(e>n||void 0===e&&n>=n)&&(e=n);else{let r=-1;for(let s of t)null!=(s=n(s,++r,t))&&(e>s||void 0===e&&s>=s)&&(e=s)}return e}function P(t,n,e=0,r=1/0,s){if(n=Math.floor(n),e=Math.floor(Math.max(0,e)),r=Math.floor(Math.min(t.length-1,r)),!(e<=n&&n<=r))return t;for(s=void 0===s?i:l(s);r>e;){if(r-e>600){const i=r-e+1,o=n-e+1,a=Math.log(i),u=.5*Math.exp(2*a/3),c=.5*Math.sqrt(a*u*(i-u)/i)*(o-i/2<0?-1:1),f=Math.max(e,Math.floor(n-o*u/i+c)),h=Math.min(r,Math.floor(n+(i-o)*u/i+c));P(t,n,f,h,s)}const i=t[n];let o=e,a=r;for(z(t,e,n),s(t[r],i)>0&&z(t,e,r);o<a;){for(z(t,o,a),++o,--a;s(t[o],i)<0;)++o;for(;s(t[a],i)>0;)--a}0===s(t[e],i)?z(t,e,a):(++a,z(t,a,r)),a<=n&&(e=a+1),n<=a&&(r=a-1)}return t}function z(t,n,e){const r=t[n];t[n]=t[e],t[e]=r}function $(t,n=i){let e,r=0,s=-1,o=t.length;if(1===n.length)for(;++s<o;)if((e=n(t[s],s,t))>=e)for(r=e;++s<o;)(e=n(t[s],s,t))>r&&(r=e);else for(;++s<o;)if((e=n(t[s],s,t))>=e){for(r=e;++s<o;)(e=n(t[s],s,t))>=e&&e>r&&(r=e);break}return r}function D(t,n=i){let e,r=-1,s=-1,o=t.length;if(1===n.length)for(;++s<o;)if((e=n(t[s],s,t))>=e)for(r=e;++s<o;)(e=n(t[s],s,t))<r&&(r=e);else for(;++s<o;)if((e=n(t[s],s,t))>=e){for(r=e;++s<o;)(e=n(t[s],s,t))>=e&&e<r&&(r=e);break}return r}function F(t,n,e=0,r=t.length-1,s=i){for(;r>e;){if(r-e>600){const i=r-e+1,o=n-e+1,a=Math.log(i),u=.5*Math.exp(2*a/3),c=.5*Math.sqrt(a*u*(i-u)/i)*(o-i/2<0?-1:1);F(t,n,Math.max(e,Math.floor(n-o*u/i+c)),Math.min(r,Math.floor(n+(i-o)*u/i+c)),s)}const i=t[n];let o=e,a=r;for(z(t,e,n),s(t[r],i)>0&&z(t,e,r);o<a;){for(z(t,o,a),++o,--a;s(t[o],i)<0;)++o;for(;s(t[a],i)>0;)--a}0===s(t[e],i)?z(t,e,a):(++a,z(t,a,r)),a<=n&&(e=a+1),n<=a&&(r=a-1)}return t}function R(t,n=i){if(r=t.length){if((n=+n)<=0||r<2)return+t[0];if(n>=1)return+t[r-1];var e=(r-1)*n,s=Math.floor(e),o=+t[s],a=+t[s+1];return o+(a-o)*(e-s)}var r}function q(t,n,e){if(r=(t=Float64Array.from(function*(t,n){if(void 0===n)for(let n of t)null!=n&&(n=+n)>=n&&(yield n);else{let e=-1;for(let r of t)null!=(r=n(r,++e,t))&&(r=+r)>=r&&(yield r)}}(t,e))).length){if((n=+n)<=0||r<2)return _(t);if(n>=1)return k(t);var r,s=(r-1)*n,i=Math.floor(s),o=_(P(t,i).subarray(0,i+1)),a=k(P(t,r-1-i).subarray(-(r-i)));return o+(a-o)*(s-i)}}function U(t,n){let e,r=0,s=-1,i=t.length;if(void 0===n)for(;++s<i;)isNaN(e=l(t[s]))||(r+=e);else for(;++s<i;)isNaN(e=l(n(t[s],s,t)))||(r+=e);return r}function I(t,n){let e=0,r=0;if(void 0===n)for(let n of t)null!=n&&(n=+n)>=n&&(++e,r+=n);else{let s=-1;for(let i of t)null!=(i=n(i,++s,t))&&(i=+i)>=i&&(++e,r+=i)}if(e)return r/e}function O(t,n){return R(t,.5,n)}function B(t,n){let e,r=[],s=t.length,i=-1;if(void 0===n)for(;++i<s;)isNaN(e=l(t[i]))||r.push(e);else for(;++i<s;)isNaN(e=l(n(t[i],i,t)))||r.push(e);return r.sort(n)}function Y(t,n){let e,r=0,s=-1,i=t.length;if(void 0===n)for(;++s<i;)(e=t[s]-r)&&(r+=e/++s);else for(;++s<i;)(e=n(t[s],s,t)-r)&&(r+=e/++s);return r}function j(t,n){return I(function*(t,n){if(void 0===n)for(let n of t)null!=n&&(yield n);else{let e=-1;for(let r of t)yield n(r,++e,t)}}(t,n))}function H(t){return Array.from(j(t))}function L(t,n){const e=H(t,n);return O(e)}function X(t,n){let e,r=0,s=0,i=-1,o=t.length;if(void 0===n)for(;++i<o;)isNaN(e=l(t[i]))||(r+=(e-r)/(++s));else for(;++i<o;)isNaN(e=l(n(t[i],i,t)))||(r+=(e-r)/(++s));return r}function G(t,n){let e=0;if(void 0===n)for(let n of t)(n=+n)&&(e+=n);else{let r=-1;for(let s of t)(s=+n(s,++r,t))&&(e+=s)}return e}function V(t){if(!(s=t.length))return[];for(var n=-1,e=C(t,J),r=new Array(e);++n<e;)for(var s,i=-1,o=r[n]=new Array(s);++i<s;)o[i]=t[i][n];return r}function W(t,n){return null==t||null==n?NaN:t<n?-1:t>n?1:t>=n?0:NaN}function Z(t,n){return null==t||null==n?NaN:n<t?-1:n>t?1:n>=t?0:NaN}function K(t){let n,e,r;function s(t,s,i=0,o=t.length){if(i<o){if(0!==r(n,n))return o;do{const r=i+o>>>1;e(t[r],n)<0?i=r+1:o=r}while(i<o)}return i}return 2!==t.length?(r=W,e=(n,e)=>W(t(n),e),n=t):(e=t===W||t===Z?t:Q,n=t,r=t),{left:s,center:function(t,i,o=0,a=t.length){const u=s(t,n,o,a-1);return u>o&&r(t[u-1],n)>-r(t[u],n)?u-1:u},right:function(t,s,i=0,o=t.length){if(i<o){if(0!==r(n,n))return o;do{const r=i+o>>>1;e(t[r],n)<=0?i=r+1:o=r}while(i<o)}return o}}}function Q(){return 0}function J(t){return null==t?0:t.length}function tt(t){return t}function nt(t){return function(){return t}}function et(t){return+t}function rt(t){return t*t}function st(t){return t*(2-t)}function it(t){return((t*=2)<=1?t*t:--t*(2-t)+1)/2}function ot(t){return t*t*t}function at(t){return--t*t*t+1}function ut(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var ct=function t(n){function e(t){return Math.pow(t,n)}return n=+n,e.exponent=t,e}(3);var ft=function t(n){function e(t){return 1-Math.pow(1-t,n)}return n=+n,e.exponent=t,e}(3);var lt=function t(n){function e(t){return((t*=2)<=1?Math.pow(t,n):2-Math.pow(2-t,n))/2}return n=+n,e.exponent=t,e}(3);const ht=Math.PI,dt=ht/2;function pt(t){return(1-Math.cos(ht*t))/2}function gt(t){return Math.sin(ht*t/2)}function yt(t){return Math.sin(ht/2*(2*t-1))/2+.5}function vt(t){return(Math.pow(2,-10*t)-.0009765625)/.9990234375}function mt(t){return 1.0009775171065494-Math.pow(2,-10*(1-t))}function bt(t){return((t*=2)<=1?(Math.pow(2,10*(t-1))-.0009765625)/.9990234375:(2.0019550342130987-Math.pow(2,10*(1-t)))/.9990234375)/2}function _t(t){return 1-Math.sqrt(1-t*t)}function wt(t){return Math.sqrt(1- --t*t)}function xt(t){return((t*=2)<=1?1-Math.sqrt(1-t*t):Math.sqrt(1-(t-=2)*t)+1)/2}const Nt=4/11,At=6/11,Tt=8/11,St=3/4,Mt=9/11,Et=10/11,kt=15/16,Ct=21/22,Pt=63/64,zt=1/Nt/$t;function $t(t){return t*t}function Dt(t){return t<Nt?zt*t*t:t<At?zt*(t-=1.5/11)*t+St:t<Mt?zt*(t-=2.25/11)*t+.9375:zt*(t-=2.625/11)*t+Pt}function Ft(t){return 1-Dt(1-t)}function Rt(t){return((t*=2)<=1?1-Dt(1-t):Dt(t-1)+1)/2}function qt(t,n){for(var e;!(e=t.next()).done;)if(!n(e.value))return!1;return!0}function Ut(t,n){for(var e;!(e=t.next()).done;)if(n(e.value))return!0;return!1}function It(t,n){return t.has(n)}function Ot(t,n,e){t.has(n)?t.get(n).push(e):t.set(n,[e])}function Bt(t,n){const e=n[Symbol.iterator](),r=new Set;for(const n of t){const t=n+="";if(r.has(t))continue;let s,i=-1;for(const{done:t,value:r}of e){if(t)break;if(++i>=n.length)break;if(n[i]!==r){s=!1;break}s=!0}if(s)return r.add(t),n}throw new Error}function Yt(t,n){const e=t[Symbol.iterator](),r=n[Symbol.iterator]();let s,i;return function(){if(s||(s=e.next()).done)return{done:!0,value:void 0};if(i||(i=r.next()).done)return i=e.next(),{done:i.done,value:i.done?void 0:[s.value,i.value]};{const t=[s.value,i.value];return i=r.next(),t}}}function jt(t){return t}function Ht(t,n,e){t=+t,n=+n,e=(s=arguments.length)<2?(n=t,t=0,1):s<3?1:+e;for(var r=-1,s=0|Math.max(0,Math.ceil((n-t)/e)),i=new Array(s);++r<s;)i[r]=t+r*e;return i}function Lt(t){return Math.max(1,Math.ceil(Math.log(Y(t))/Math.LN2)+1)}function Xt(t,n){let e=0,r=t.length,s=t[0],i=new Array(r+r);for(n||(n=l);++e<r;)i[e]=n(s,s=t[e]);return[new Array(i.slice(1,e+1)),new Array(i.slice(e+1,e+e))]}function Gt(t,n){return n<t?-1:n>t?1:n>=t?0:NaN}function Vt(t){return t}const Wt=d(k),Zt=d(_);var Kt=Array.prototype,Qt=Kt.slice,Jt=Kt.map;function tn(t){return()=>t}const nn=Math.PI,en=2*nn,rn=1e-6,sn=en-rn;function on(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function an(){return new on}on.prototype=an.prototype={constructor:on,moveTo:function(t,n){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+n)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,n){this._+="L"+(this._x1=+t)+","+(this._y1=+n)},quadraticCurveTo:function(t,n,e,r){this._+="Q"+ +t+","+ +n+","+(this._x1=+e)+","+(this._y1=+r)},bezierCurveTo:function(t,n,e,r,s,i){this._+="C"+ +t+","+ +n+","+ +e+","+ +r+","+(this._x1=+s)+","+(this._y1=+i)},arcTo:function(t,n,e,r,s){t=+t,n=+n,e=+e,r=+r,s=+s;var i=this._x1,o=this._y1,a=e-t,u=r-n,c=i-t,f=o-n,l=c*c+f*f;if(s<0)throw new Error("negative radius: "+s);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=n);else if(l>rn)if(Math.abs(f*a-u*c)>rn&&s){var h=e-i,d=r-o,p=a*a+u*u,g=h*h+d*d,y=Math.sqrt(p),v=Math.sqrt(l),m=s*Math.tan((nn-Math.acos((p+l-g)/(2*y*v)))/2),b=m/v,_=m/y;Math.abs(b-1)>rn&&(this._+="L"+(t+b*c)+","+(n+b*f)),this._+="A"+s+","+s+",0,0,"+ +(f*h>c*d)+","+(this._x1=t+_*a)+","+(this._y1=n+_*u)}else this._+="L"+(this._x1=t)+","+(this._y1=n);else;},arc:function(t,n,e,r,s,i){t=+t,n=+n,e=+e,i=!!i;var o=e*Math.cos(r),a=e*Math.sin(r),u=t+o,c=n+a,f=1^i,l=i?r-s:s-r;if(e<0)throw new Error("negative radius: "+e);null===this._x1?this._+="M"+u+","+c:(Math.abs(this._x1-u)>rn||Math.abs(this._y1-c)>rn)&&(this._+="L"+u+","+c),e&&(l<0&&(l=l%en+en),l>sn?this._+="A"+e+","+e+",0,1,"+f+","+(t-o)+","+(n-a)+"A"+e+","+e+",0,1,"+f+","+(this._x1=u)+","+(this._y1=c):l>rn&&(this._+="A"+e+","+e+",0,"+ +(l>=nn)+","+f+","+(this._x1=t+e*Math.cos(s))+","+(this._y1=n+e*Math.sin(s))))},rect:function(t,n,e,r){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+n)+"h"+ +e+"v"+ +r+"h"+ -e+"Z"},toString:function(){return this._}};function un(t){let n=3;return t.digits=function(e){if(!arguments.length)return n;if("number"!=typeof e)throw new Error("digits is not a number");if(e>15)throw new Error("digits greater than 15");return n=e,t},()=>new an}function cn(t){return t}var fn,ln,hn,dn,pn,gn=function(t){return()=>t};function yn(t,n){return n.length-t.length}function vn(t,n){return void 0===t&&(t=0),void 0===n&&(n=1),1===arguments.length?(n=t,t=0):n-=t,function(){return Math.random()*n+t}}function mn(t,n){var e,r;return void 0===t&&(t=0),void 0===n&&(n=1),function(){var s;if(null!=e)s=e,e=null;else do{e=2*Math.random()-1,s=2*Math.random()-1,r=e*e+s*s}while(!r||r>1);return t+n*s*Math.sqrt(-2*Math.log(r)/r)}}function bn(){return fn.raw(...arguments)}function _n(t){return t}function wn(t){return"translate("+(t+.5)+",0)"}function xn(t){return"translate(0,"+(t+.5)+")"}function Nn(t){return n=>+t(n)}function An(t,n){return n=Math.max(0,t.bandwidth()-2*n)/2,t.round()&&(n=Math.round(n)),e=>+t(e)+n}function Tn(){return!this.__axis}function Sn(t,n){var e=[],r=null,s=null,i=6,o=6,a=3,u=1===t||4===t?-1:1,c=4===t||2===t?"x":"y",f=1===t||3===t?wn:xn;function l(l){var h=null==r?n.ticks?n.ticks.apply(n,e):n.domain():r,d=null==s?n.tickFormat?n.tickFormat.apply(n,e):_n:s,p=Math.max(i,0)+a,g=n.range(),y=+g[0]+.5,v=+g[g.length-1]+.5,m=(n.bandwidth?An:Nn)(n.copy(),u),b=l.selection?l.selection():l,_=b.selectAll(".domain").data([null]),w=b.selectAll(".tick").data(h,n).order(),x=w.exit(),N=w.enter().append("g").attr("class","tick"),A=w.select("line"),T=w.select("text");_.enter().append("path").attr("class","domain").attr("stroke","currentColor"),N.append("line").attr("stroke","currentColor"),N.append("text").attr("fill","currentColor").attr(c,u*p).attr("dy",1===t?"0em":3===t?"0.71em":"0.32em"),l!==b&&(_.transition(l),w.transition(l),N.transition(l),x.transition(l).attr("opacity",rn).attr("transform",function(t){return isFinite(t=m(t))?f(t+u):this.getAttribute("transform")}),N.attr("opacity",rn).attr("transform",function(t){var n=this.parentNode.__axis;return f((n&&isFinite(n=n(t))?n:m(t))+u)})),x.remove(),_.attr("d",4===t||2==t?i?"M"+u*i+","+y+"H0.5V"+v+"H"+u*i:"M0.5,"+y+"V"+v:i?"M"+y+","+u*i+"V0.5H"+v+"V"+u*i:"M"+y+",0.5H"+v),A.attr(c+"2",u*i),T.attr(c,u*p).text(d),b.filter(Tn).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",2===t?"start":4===t?"end":"middle"),b.each(function(){this.__axis=m})}return l.scale=function(t){return arguments.length?(n=t,l):n},l.ticks=function(...t){return e=Qt.call(t),l},l.tickArguments=function(t){return arguments.length?(e=null==t?[]:Qt.call(t),l):e.slice()},l.tickValues=function(t){return arguments.length?(r="function"==typeof t?null:Qt.call(t),l):r&&r.slice()},l.tickFormat=function(t){return arguments.length?(s=t,l):s},l.tickSize=function(t){return arguments.length?(i=o=+t,l):i},l.tickSizeInner=function(t){return arguments.length?(i=+t,l):i},l.tickSizeOuter=function(t){return arguments.length?(o=+t,l):o},l.tickPadding=function(t){return arguments.length?(a=+t,l):a},l.offset=function(t){return arguments.length?(u=+t,l):u},l}function Mn(t){return Sn(1,t)}function En(t){return Sn(2,t)}function kn(t){return Sn(3,t)}function Cn(t){return Sn(4,t)}var Pn=Array.prototype.slice;function zn(t,n){return t-n}var $n=t=>()=>t;function Dn(t,n){for(var e,r=-1,s=n.length;++r<s;)if(e=Fn(t,n[r]))return e;return 0}function Fn(t,n){for(var e=n[0],r=n[1],s=-1,i=0,o=t.length,a=o-1;i<o;a=i++){var u=t[i],c=u[0],f=u[1],l=t[a],h=l[0],d=l[1];if(Rn(u,l,n))return 0;f>r!=d>r&&e<(h-c)*(r-f)/(d-f)+c&&(s=-s)}return s}function Rn(t,n,e){var r,s,i,o;return function(t,n,e){return(n[0]-t[0])*(e[1]-t[1])==(e[0]-t[0])*(n[1]-t[1])}(t,n,e)&&(r=t[0],s=n[0],i=e[0],o=t[1],s<r&&(r=s),i<r||i>(s<r?s:r)||((s=o)<(o=n[1])&&(o=s),e[1]<o||e[1]>(s<o?s:o)))}var qn=function(t){return t[0]},Un=function(t){return t[1]};function In(t,n){var e=!0;function r(t){return e?t:"M"+t.join("L")+"Z"}function s(t){for(var n,e,r,s=0,i=t.length,o=t[i-1],a=o[0],u=o[1],c=0;s<i;++s)n=a,e=u,o=t[s],a=o[0],u=o[1],n-=a,e-=u,c+=Math.hypot(n,e);return c}return t.area=function(){return s(n.apply(this,arguments))},t.perimeter=r,t.perimeter.valid=function(t){return arguments.length?(e=!!t,r):e},t}var On=1e9,Bn=-On;function Yn(t,n,e,r){function s(s){return t<=s&&s<=n&&e<=r&&r<=i}function i(s){var i,o,c,f,l;return s&&(i=t-s[0])>0&&(o=s[1]-n)>0&&(c=e-s[2])>0&&(f=s[3]-r)>0&&(l=Math.min(i,o,c,f))>0&&(i===l&&(t=s[0]-l),o===l&&(n=s[1]+l),c===l&&(e=s[2]-l),f===l&&(r=s[3]+l),!0)}function o(){var s,i,o,u,c,f=Number.MAX_VALUE,l=Number.MAX_VALUE,h=-Number.MAX_VALUE,d=-Number.MAX_VALUE;a.forEach(function(t){t.x<f&&(f=t.x),t.x>h&&(h=t.x),t.y<l&&(l=t.y),t.y>d&&(d=t.y)}),s=h-f,i=d-l,o=Math.min(s,i),u=o/2;if(a.forEach(function(t){t.max=Math.min(t.z,o/2)}),a.sort(function(t,n){return n.max-t.max}),0!==a.length){if(1===a.length)return c=a[0],c. * 1000 characters);
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>CQSS Project Gantt Chart</h1>
            <p>Cyber Query Security System - Project Timeline Overview</p>
        </div>
        
        <div class="controls">
            <div>
                <button onclick="zoomIn()">Zoom In</button>
                <button onclick="zoomOut()">Zoom Out</button>
                <button onclick="resetZoom()">Reset</button>
            </div>
            <div>
                <span id="project-count">Loading projects...</span>
            </div>
        </div>
        
        <div class="gantt-container" id="gantt-container">
            <svg class="gantt-chart"></svg>
        </div>
        
        <div class="legend">
            <div class="legend-item">
                <div class="legend-color" style="background-color: #6c757d;"></div>
                <span>Preparing</span>
            </div>
            <div class="legend-item">
                <div class="legend-color priority-critical"></div>
                <span>Critical Priority</span>
            </div>
            <div class="legend-item">
                <div class="legend-color priority-high"></div>
                <span>High Priority</span>
            </div>
            <div class="legend-item">
                <div class="legend-color priority-medium"></div>
                <span>Medium Priority</span>
            </div>
            <div class="legend-item">
                <div class="legend-color priority-low"></div>
                <span>Low Priority</span>
            </div>
        </div>
    </div>
    
    <div class="tooltip" id="tooltip" style="display: none;"></div>
    
    <script>
        // D3.js library is too large to embed here (over 1000 lines)
        // Using CDN fallback with local fallback capability
        (function(){
            // Check if d3 is loaded
            if (typeof d3 === 'undefined') {
                // Fallback: load from CDN
                var script = document.createElement('script');
                script.src = 'https://d3js.org/d3.v7.min.js';
                script.onload = initChart;
                document.head.appendChild(script);
            } else {
                initChart();
            }
        })();

        let currentZoom = 1;
        let svg, g, projectGroups;

        function initChart() {
            // Project data will be embedded here
            const projectData = [
  {
    "id": "project_0",
    "name": "Project Alpha Security Enhancement",
    "category": "Security",
    "priority": "Critical",
    "description": "Implement new multi-factor authentication system",
    "team_lead": "John Smith",
    "preparing_stage": {
      "start": "2024-01-15T00:00:00",
      "end": "2024-02-15T00:00:00",
      "duration_days": 31
    },
    "execution_stage": {
      "start": "2024-02-15T00:00:00",
      "end": "2024-05-15T00:00:00",
      "duration_days": 90,
      "progress_percent": 75
    },
    "total_duration_days": 121
  },
  {
    "id": "project_1",
    "name": "Project Beta Database Migration",
    "category": "Infrastructure",
    "priority": "High",
    "description": "Database migration and performance optimization",
    "team_lead": "Jane Doe",
    "preparing_stage": {
      "start": "2024-02-01T00:00:00",
      "end": "2024-03-01T00:00:00",
      "duration_days": 29
    },
    "execution_stage": {
      "start": "2024-03-01T00:00:00",
      "end": "2024-06-01T00:00:00",
      "duration_days": 92,
      "progress_percent": 45
    },
    "total_duration_days": 121
  },
  {
    "id": "project_2",
    "name": "Project Gamma Frontend Redesign",
    "category": "Development",
    "priority": "High",
    "description": "Complete frontend redesign and UX improvements",
    "team_lead": "Mike Johnson",
    "preparing_stage": {
      "start": "2024-01-01T00:00:00",
      "end": "2024-01-15T00:00:00",
      "duration_days": 14
    },
    "execution_stage": {
      "start": "2024-01-15T00:00:00",
      "end": "2024-04-01T00:00:00",
      "duration_days": 77,
      "progress_percent": 90
    },
    "total_duration_days": 91
  },
  {
    "id": "project_3",
    "name": "Project Delta GDPR Compliance",
    "category": "Compliance",
    "priority": "Critical",
    "description": "GDPR compliance implementation and audit",
    "team_lead": "Sarah Wilson",
    "preparing_stage": {
      "start": "2024-03-01T00:00:00",
      "end": "2024-03-15T00:00:00",
      "duration_days": 14
    },
    "execution_stage": {
      "start": "2024-03-15T00:00:00",
      "end": "2024-07-01T00:00:00",
      "duration_days": 108,
      "progress_percent": 30
    },
    "total_duration_days": 122
  },
  {
    "id": "project_4",
    "name": "Project Epsilon AI Research",
    "category": "Research",
    "priority": "Medium",
    "description": "AI integration feasibility study and prototyping",
    "team_lead": "David Brown",
    "preparing_stage": {
      "start": "2024-02-15T00:00:00",
      "end": "2024-04-15T00:00:00",
      "duration_days": 60
    },
    "execution_stage": {
      "start": "2024-04-15T00:00:00",
      "end": "2024-08-15T00:00:00",
      "duration_days": 122,
      "progress_percent": 10
    },
    "total_duration_days": 182
  },
  {
    "id": "project_5",
    "name": "Project Zeta Cloud Migration",
    "category": "Infrastructure",
    "priority": "High",
    "description": "Complete cloud infrastructure migration",
    "team_lead": "Lisa Chen",
    "preparing_stage": {
      "start": "2024-01-20T00:00:00",
      "end": "2024-02-20T00:00:00",
      "duration_days": 31
    },
    "execution_stage": {
      "start": "2024-02-20T00:00:00",
      "end": "2024-05-20T00:00:00",
      "duration_days": 90,
      "progress_percent": 65
    },
    "total_duration_days": 121
  },
  {
    "id": "project_6",
    "name": "Project Eta Mobile App Development",
    "category": "Development",
    "priority": "Medium",
    "description": "Native mobile application development",
    "team_lead": "Robert Taylor",
    "preparing_stage": {
      "start": "2024-02-10T00:00:00",
      "end": "2024-03-10T00:00:00",
      "duration_days": 29
    },
    "execution_stage": {
      "start": "2024-03-10T00:00:00",
      "end": "2024-06-10T00:00:00",
      "duration_days": 92,
      "progress_percent": 55
    },
    "total_duration_days": 121
  },
  {
    "id": "project_7",
    "name": "Project Theta API Gateway Implementation",
    "category": "Development",
    "priority": "High",
    "description": "Implement unified API gateway architecture",
    "team_lead": "Emma Davis",
    "preparing_stage": {
      "start": "2024-01-05T00:00:00",
      "end": "2024-01-25T00:00:00",
      "duration_days": 20
    },
    "execution_stage": {
      "start": "2024-01-25T00:00:00",
      "end": "2024-04-25T00:00:00",
      "duration_days": 91,
      "progress_percent": 80
    },
    "total_duration_days": 111
  },
  {
    "id": "project_8",
    "name": "Project Iota Data Analytics Platform",
    "category": "Analytics",
    "priority": "Medium",
    "description": "Build comprehensive data analytics platform",
    "team_lead": "Alex Martinez",
    "preparing_stage": {
      "start": "2024-02-25T00:00:00",
      "end": "2024-03-25T00:00:00",
      "duration_days": 29
    },
    "execution_stage": {
      "start": "2024-03-25T00:00:00",
      "end": "2024-07-25T00:00:00",
      "duration_days": 122,
      "progress_percent": 25
    },
    "total_duration_days": 151
  },
  {
    "id": "project_9",
    "name": "Project Kappa Cybersecurity Audit",
    "category": "Security",
    "priority": "Critical",
    "description": "Complete cybersecurity audit and remediation",
    "team_lead": "Jennifer Lee",
    "preparing_stage": {
      "start": "2024-01-30T00:00:00",
      "end": "2024-02-28T00:00:00",
      "duration_days": 29
    },
    "execution_stage": {
      "start": "2024-02-28T00:00:00",
      "end": "2024-05-28T00:00:00",
      "duration_days": 90,
      "progress_percent": 40
    },
    "total_duration_days": 119
  },
  {
    "id": "project_10",
    "name": "Project Lambda Performance Optimization",
    "category": "Infrastructure",
    "priority": "High",
    "description": "System performance optimization and tuning",
    "team_lead": "Mark Anderson",
    "preparing_stage": {
      "start": "2024-02-05T00:00:00",
      "end": "2024-03-05T00:00:00",
      "duration_days": 29
    },
    "execution_stage": {
      "start": "2024-03-05T00:00:00",
      "end": "2024-06-05T00:00:00",
      "duration_days": 92,
      "progress_percent": 70
    },
    "total_duration_days": 121
  },
  {
    "id": "project_11",
    "name": "Project Mu User Training Program",
    "category": "Training",
    "priority": "Low",
    "description": "Comprehensive user training program development",
    "team_lead": "Carol White",
    "preparing_stage": {
      "start": "2024-03-10T00:00:00",
      "end": "2024-04-10T00:00:00",
      "duration_days": 31
    },
    "execution_stage": {
      "start": "2024-04-10T00:00:00",
      "end": "2024-07-10T00:00:00",
      "duration_days": 91,
      "progress_percent": 15
    },
    "total_duration_days": 122
  },
  {
    "id": "project_12",
    "name": "Project Nu Backup System Upgrade",
    "category": "Infrastructure",
    "priority": "Medium",
    "description": "Backup and disaster recovery system upgrade",
    "team_lead": "Kevin Rodriguez",
    "preparing_stage": {
      "start": "2024-01-25T00:00:00",
      "end": "2024-02-25T00:00:00",
      "duration_days": 31
    },
    "execution_stage": {
      "start": "2024-02-25T00:00:00",
      "end": "2024-05-25T00:00:00",
      "duration_days": 90,
      "progress_percent": 85
    },
    "total_duration_days": 121
  },
  {
    "id": "project_13",
    "name": "Project Xi Integration Testing",
    "category": "Testing",
    "priority": "High",
    "description": "Comprehensive integration testing framework",
    "team_lead": "Michelle Brown",
    "preparing_stage": {
      "start": "2024-02-20T00:00:00",
      "end": "2024-03-20T00:00:00",
      "duration_days": 29
    },
    "execution_stage": {
      "start": "2024-03-20T00:00:00",
      "end": "2024-06-20T00:00:00",
      "duration_days": 92,
      "progress_percent": 60
    },
    "total_duration_days": 121
  },
  {
    "id": "project_14",
    "name": "Project Omicron Documentation Update",
    "category": "Documentation",
    "priority": "Low",
    "description": "Update all technical documentation and guides",
    "team_lead": "Thomas Garcia",
    "preparing_stage": {
      "start": "2024-03-05T00:00:00",
      "end": "2024-04-05T00:00:00",
      "duration_days": 31
    },
    "execution_stage": {
      "start": "2024-04-05T00:00:00",
      "end": "2024-07-05T00:00:00",
      "duration_days": 91,
      "progress_percent": 20
    },
    "total_duration_days": 122
  },
  {
    "id": "project_15",
    "name": "Project Pi Quality Assurance",
    "category": "Testing",
    "priority": "Medium",
    "description": "Complete quality assurance testing suite",
    "team_lead": "Rachel Kim",
    "preparing_stage": {
      "start": "2024-01-10T00:00:00",
      "end": "2024-02-10T00:00:00",
      "duration_days": 31
    },
    "execution_stage": {
      "start": "2024-02-10T00:00:00",
      "end": "2024-05-10T00:00:00",
      "duration_days": 90,
      "progress_percent": 95
    },
    "total_duration_days": 121
  },
  {
    "id": "project_16",
    "name": "Project Rho Vendor Management",
    "category": "Operations",
    "priority": "Low",
    "description": "Vendor management system implementation",
    "team_lead": "Steven Thompson",
    "preparing_stage": {
      "start": "2024-02-28T00:00:00",
      "end": "2024-03-28T00:00:00",
      "duration_days": 29
    },
    "execution_stage": {
      "start": "2024-03-28T00:00:00",
      "end": "2024-06-28T00:00:00",
      "duration_days": 92,
      "progress_percent": 35
    },
    "total_duration_days": 121
  },
  {
    "id": "project_17",
    "name": "Project Sigma Monitoring System",
    "category": "Infrastructure",
    "priority": "High",
    "description": "Advanced monitoring and alerting system",
    "team_lead": "Amanda Jackson",
    "preparing_stage": {
      "start": "2024-01-15T00:00:00",
      "end": "2024-02-15T00:00:00",
      "duration_days": 31
    },
    "execution_stage": {
      "start": "2024-02-15T00:00:00",
      "end": "2024-05-15T00:00:00",
      "duration_days": 90,
      "progress_percent": 50
    },
    "total_duration_days": 121
  },
  {
    "id": "project_18",
    "name": "Project Tau DevOps Pipeline",
    "category": "Development",
    "priority": "High",
    "description": "CI/CD pipeline implementation and automation",
    "team_lead": "Ryan Wilson",
    "preparing_stage": {
      "start": "2024-02-12T00:00:00",
      "end": "2024-03-12T00:00:00",
      "duration_days": 29
    },
    "execution_stage": {
      "start": "2024-03-12T00:00:00",
      "end": "2024-06-12T00:00:00",
      "duration_days": 92,
      "progress_percent": 75
    },
    "total_duration_days": 121
  },
  {
    "id": "project_19",
    "name": "Project Upsilon Load Testing",
    "category": "Testing",
    "priority": "Medium",
    "description": "Comprehensive load testing and optimization",
    "team_lead": "Nicole Harris",
    "preparing_stage": {
      "start": "2024-03-01T00:00:00",
      "end": "2024-04-01T00:00:00",
      "duration_days": 31
    },
    "execution_stage": {
      "start": "2024-04-01T00:00:00",
      "end": "2024-07-01T00:00:00",
      "duration_days": 91,
      "progress_percent": 30
    },
    "total_duration_days": 122
  }
];
            const dateRange = {
  "min_date": "2024-01-01T00:00:00",
  "max_date": "2024-08-15T00:00:00"
};
            
            document.getElementById('project-count').textContent = `${projectData.length} projects loaded`;
            
            // Chart configuration
            const margin = { top: 50, right: 50, bottom: 100, left: 280 };
            const width = Math.max(1600, window.innerWidth * 1.5) - margin.left - margin.right;
            const height = Math.max(600, projectData.length * 70) - margin.top - margin.bottom;
            const barHeight = 32;
            const rowHeight = 70;
            
            // Create SVG
            svg = d3.select('.gantt-chart')
                .attr('width', width + margin.left + margin.right)
                .attr('height', height + margin.top + margin.bottom);
            
            g = svg.append('g')
                .attr('transform', `translate(${margin.left},${margin.top})`);
            
            // Parse dates
            const parseTime = d3.timeParse('%Y-%m-%dT%H:%M:%S');
            const minDate = parseTime(dateRange.min_date);
            const maxDate = parseTime(dateRange.max_date);
            
            // Calculate 2-week range starting from Sunday
            function getStartOfWeek(date) {
                const d = new Date(date);
                const day = d.getDay(); // 0 = Sunday, 1 = Monday, etc.
                const diff = d.getDate() - day;
                return new Date(d.setDate(diff));
            }
            
            // Set timeline to 2-week range (Sunday to Saturday)
            const startOfFirstWeek = getStartOfWeek(minDate);
            const endOfSecondWeek = new Date(startOfFirstWeek);
            endOfSecondWeek.setDate(startOfFirstWeek.getDate() + 13); // 14 days total (2 weeks)
            
            const paddedMinDate = startOfFirstWeek;
            const paddedMaxDate = endOfSecondWeek;
            
            // Scales
            const xScale = d3.scaleTime()
                .domain([paddedMinDate, paddedMaxDate])
                .range([0, width]);
            
            const yScale = d3.scaleBand()
                .domain(projectData.map(d => d.name))
                .range([0, height])
                .padding(0.1);
            
            // Priority color scale
            const priorityColors = {
                'Critical': '#dc3545',
                'High': '#fd7e14',
                'Medium': '#ffc107',
                'Low': '#28a745'
            };
            
            // Create tooltip
            const tooltip = d3.select('#tooltip');
            
            // Add axes with daily ticks
            const xAxis = d3.axisBottom(xScale)
                .tickFormat(d => {
                    const dayNames = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
                    return dayNames[d.getDay()] + '\\n' + d3.timeFormat('%m/%d')(d);
                })
                .ticks(d3.timeDay.every(1));
            
            g.append('g')
                .attr('class', 'axis')
                .attr('transform', `translate(0,${height})`)
                .call(xAxis)
                .selectAll('text')
                .style('text-anchor', 'middle')
                .style('font-size', '10px')
                .attr('dy', '1em');
            
            // Add week separators
            const weekTicks = d3.timeWeek.range(paddedMinDate, paddedMaxDate, 1);
            g.selectAll('.week-separator')
                .data(weekTicks)
                .enter()
                .append('line')
                .attr('class', 'week-separator')
                .attr('x1', d => xScale(d))
                .attr('x2', d => xScale(d))
                .attr('y1', 0)
                .attr('y2', height)
                .style('stroke', '#007bff')
                .style('stroke-width', 2)
                .style('opacity', 0.7);
            
            const yAxis = d3.axisLeft(yScale);
            
            g.append('g')
                .attr('class', 'axis')
                .call(yAxis);
            
            // Add daily grid lines
            g.append('g')
                .attr('class', 'grid')
                .attr('transform', `translate(0,${height})`)
                .call(d3.axisBottom(xScale)
                    .tickSize(-height)
                    .tickFormat('')
                    .ticks(d3.timeDay.every(1))
                )
                .style('stroke-dasharray', '2,2')
                .style('opacity', 0.2);
            
            // Add weekend highlighting
            const weekendDays = d3.timeDay.range(paddedMinDate, paddedMaxDate, 1)
                .filter(d => d.getDay() === 0 || d.getDay() === 6); // Sunday = 0, Saturday = 6
            
            g.selectAll('.weekend-highlight')
                .data(weekendDays)
                .enter()
                .append('rect')
                .attr('class', 'weekend-highlight')
                .attr('x', d => xScale(d))
                .attr('y', 0)
                .attr('width', xScale(new Date(paddedMinDate.getTime() + 24*60*60*1000)) - xScale(paddedMinDate))
                .attr('height', height)
                .style('fill', '#f8f9fa')
                .style('opacity', 0.5);
            
            // Create project groups
            projectGroups = g.selectAll('.project-group')
                .data(projectData)
                .enter()
                .append('g')
                .attr('class', 'project-group')
                .attr('transform', d => `translate(0,${yScale(d.name)})`);
            
            // Add preparing stage bars
            projectGroups.append('rect')
                .attr('class', 'preparing-bar')
                .attr('x', d => xScale(parseTime(d.preparing_stage.start)))
                .attr('y', (yScale.bandwidth() - barHeight) / 2)
                .attr('width', d => xScale(parseTime(d.preparing_stage.end)) - xScale(parseTime(d.preparing_stage.start)))
                .attr('height', barHeight);
            
            // Add execution stage background bars
            projectGroups.append('rect')
                .attr('class', 'execution-bar')
                .attr('x', d => xScale(parseTime(d.execution_stage.start)))
                .attr('y', (yScale.bandwidth() - barHeight) / 2)
                .attr('width', d => xScale(parseTime(d.execution_stage.end)) - xScale(parseTime(d.execution_stage.start)))
                .attr('height', barHeight)
                .attr('fill', d => priorityColors[d.priority] || '#6c757d')
                .attr('opacity', 0.3);
            
            // Add execution stage progress bars
            projectGroups.append('rect')
                .attr('class', 'progress-bar execution-bar')
                .attr('x', d => xScale(parseTime(d.execution_stage.start)))
                .attr('y', (yScale.bandwidth() - barHeight) / 2)
                .attr('width', d => {
                    const totalWidth = xScale(parseTime(d.execution_stage.end)) - xScale(parseTime(d.execution_stage.start));
                    return totalWidth * (d.execution_stage.progress_percent / 100);
                })
                .attr('height', barHeight)
                .attr('fill', d => priorityColors[d.priority] || '#6c757d')
                .style('cursor', 'pointer')
                .on('mouseover', function(event, d) {
                    tooltip.style('display', 'block')
                        .html(`
                            <div class="tooltip-title">${d.name}</div>
                            <div class="tooltip-item"><strong>Category:</strong> ${d.category}</div>
                            <div class="tooltip-item"><strong>Priority:</strong> ${d.priority}</div>
                            <div class="tooltip-item"><strong>Team Lead:</strong> ${d.team_lead}</div>
                            <div class="tooltip-item"><strong>Progress:</strong> ${d.execution_stage.progress_percent}%</div>
                            <div class="tooltip-item"><strong>Description:</strong> ${d.description}</div>
                            <div class="tooltip-item"><strong>Preparing:</strong> ${d.preparing_stage.start.split('T')[0]} to ${d.preparing_stage.end.split('T')[0]}</div>
                            <div class="tooltip-item"><strong>Execution:</strong> ${d.execution_stage.start.split('T')[0]} to ${d.execution_stage.end.split('T')[0]}</div>
                        `);
                })
                .on('mousemove', function(event) {
                    tooltip.style('left', (event.pageX + 10) + 'px')
                        .style('top', (event.pageY - 10) + 'px');
                })
                .on('mouseout', function() {
                    tooltip.style('display', 'none');
                })
                .on('click', function(event, d) {
                    alert(`Project Details:\\n\\nName: ${d.name}\\nCategory: ${d.category}\\nPriority: ${d.priority}\\nTeam Lead: ${d.team_lead}\\nProgress: ${d.execution_stage.progress_percent}%\\nDescription: ${d.description}`);
                });
            
            // Add project names to execution bars
            projectGroups.append('text')
                .attr('x', d => {
                    const startX = xScale(parseTime(d.execution_stage.start));
                    const endX = xScale(parseTime(d.execution_stage.end));
                    return startX + (endX - startX) / 2;
                })
                .attr('y', (yScale.bandwidth() - barHeight) / 2 + barHeight / 2 - 4)
                .attr('dy', '0.35em')
                .attr('text-anchor', 'middle')
                .style('font-size', '13px')
                .style('font-weight', 'bold')
                .style('fill', 'white')
                .style('text-shadow', '1px 1px 3px rgba(0,0,0,0.9)')
                .text(d => {
                    const barWidth = xScale(parseTime(d.execution_stage.end)) - xScale(parseTime(d.execution_stage.start));
                    const maxChars = Math.floor(barWidth / 8); // Estimate characters that fit
                    return d.name.length > maxChars && maxChars > 3 ? 
                        d.name.substring(0, maxChars - 3) + '...' : d.name;
                });

            // Add progress percentage labels at end of progress bar
            projectGroups.append('text')
                .attr('x', d => {
                    const startX = xScale(parseTime(d.execution_stage.start));
                    const totalWidth = xScale(parseTime(d.execution_stage.end)) - startX;
                    const progressWidth = totalWidth * (d.execution_stage.progress_percent / 100);
                    // Position at the end of the progress bar, with a small offset
                    return startX + progressWidth + 5;
                })
                .attr('y', (yScale.bandwidth() - barHeight) / 2 + barHeight / 2)
                .attr('dy', '0.35em')
                .attr('text-anchor', 'start')
                .style('font-size', '11px')
                .style('font-weight', 'bold')
                .style('fill', '#343a40')
                .style('text-shadow', '1px 1px 2px rgba(255,255,255,0.8)')
                .text(d => {
                    const barWidth = xScale(parseTime(d.execution_stage.end)) - xScale(parseTime(d.execution_stage.start));
                    const progressWidth = barWidth * (d.execution_stage.progress_percent / 100);
                    // Show percentage if there's enough space and progress > 0
                    return progressWidth > 20 && d.execution_stage.progress_percent > 0 ? `${d.execution_stage.progress_percent}%` : '';
                });
            
            // Add chart title
            svg.append('text')
                .attr('x', (width + margin.left + margin.right) / 2)
                .attr('y', 30)
                .attr('text-anchor', 'middle')
                .style('font-size', '16px')
                .style('font-weight', 'bold')
                .style('fill', '#343a40')
                .text('Project Timeline and Progress Overview');
        }

        function zoomIn() {
            if (currentZoom < 3) {
                currentZoom *= 1.2;
                applyZoom();
            }
        }

        function zoomOut() {
            if (currentZoom > 0.5) {
                currentZoom /= 1.2;
                applyZoom();
            }
        }

        function resetZoom() {
            currentZoom = 1;
            applyZoom();
        }

        function applyZoom() {
            if (svg && g) {
                g.attr('transform', `translate(${280},${50}) scale(${currentZoom})`);
                // Adjust text size inversely to zoom
                g.selectAll('text').style('font-size', `${Math.max(8, 12/currentZoom)}px`);
            }
        }
    </script>
</body>
</html>